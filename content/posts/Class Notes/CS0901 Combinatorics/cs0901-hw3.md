---
tags:
- learning
- math
- combinatorics
- homework
discipline: mathematics
publish: true
date: '2025-10-05T23:00:00+08:00'
title: CS0901 HW3
categories:
- course-note
---
## Problem 1

证明
{{< math >}}

\begin{align*}
\sum_{i=0}^{n} (-1)^{i}\binom{ n }{ i } \binom{ n+m-i }{ k-i } = \binom{ m }{ k }  \\
\sum_{i=0}^{n} \binom{ k }{ i } D_{n-i} = \sum_{j=0}^{n-k} (-1)^{j}\binom{ n-k }{ j } (n-j)!
\end{align*}

{{< /math >}}
**证 1**

对于第一个式子，我们考虑组合意义。设有 {{< imath >}}A,B{{< /imath >}} 两个集合，分别包含 {{< imath >}}n{{< /imath >}} 和 {{< imath >}}m{{< /imath >}} 个元素，总共 {{< imath >}}n+m{{< /imath >}} 个元素。我们希望从集合 {{< imath >}}B{{< /imath >}} 中恰好选择 {{< imath >}}k{{< /imath >}} 个元素。我们可以通过容斥原理的补集形式求解，定义事件 {{< imath >}}A_{i}{{< /imath >}} 为所选的 {{< imath >}}k{{< /imath >}} 个元素中至少包含 {{< imath >}}i{{< /imath >}} 个来自 {{< imath >}}A{{< /imath >}} 的元素，那么我们需要求解的事件集合为 {{< imath >}}U\setminus\bigcup_{i\leq n}A_{i}{{< /imath >}}，并且
{{< math >}}

\left| A_{i} \right| = \binom{ n }{ i } \binom{ n+m-i }{ k-i } 

{{< /math >}}
因此根据容斥原理，就可以得到
{{< math >}}

\left| U\setminus \bigcup_{i\leq n}A_{i} \right| = \sum_{i=0}^{n} (-1)^{i}\binom{ n }{ i } \binom{ n+m-i }{ k-i } = \binom{ m }{ k }  

{{< /math >}}

对于第二个式子，同样考虑组合意义。我们可以假定 {{< imath >}}n\geq k{{< /imath >}}，否则两侧均为零。设有 {{< imath >}}n{{< /imath >}} 个元素的排列，分成 {{< imath >}}A{{< /imath >}} 和 {{< imath >}}B{{< /imath >}} 两部分，分别包含 {{< imath >}}k{{< /imath >}} 和 {{< imath >}}n-k{{< /imath >}} 个元素。左侧所有枚举所有 {{< imath >}}A{{< /imath >}} 中元素的组合固定，剩下的进行错排，可以表示 {{< imath >}}A{{< /imath >}} 中元素任意，{{< imath >}}B{{< /imath >}} 中元素必须为错排的方案数。我们同样考虑通过容斥原理的补集形式来求解。右侧我们定义事件 {{< imath >}}B_{i}{{< /imath >}} 表示 {{< imath >}}B{{< /imath >}} 中至少有 {{< imath >}}i{{< /imath >}} 个元素不是错排（值等于自己的编号），剩下的数随意，于是 {{< imath >}}\left| B_{i} \right|=\binom{ n-k }{ i }(n-i)!{{< /imath >}}。同时我们需要求解的事件集合为 {{< imath >}}U\setminus\bigcup_{i=1}^{n-k}B_{i}{{< /imath >}}，因此根据容斥原理可以得到
{{< math >}}

\left| U\setminus \bigcup_{j=1}^{n-k}B_{j} \right| = \sum_{i=0}^{n} \binom{ k }{ i } D_{n-i} = \sum_{j=0}^{n-k} (-1)^{j}\binom{ n-k }{ j } (n-j)!

{{< /math >}}
**证 2**：

这两个式子和二项反演都有一定的类似之处。
{{< math >}}

g_{n} = \sum_{i=0}^{n} \binom{ n }{ i } f_{i} \implies f_{n} = \sum_{i=0}^{n} (-1)^{n-i}\binom{ n }{ i } g_{i}

{{< /math >}}
我们直接证明二项反演。

将 {{< imath >}}g_{i}{{< /imath >}} 的表达式带入要证明的式子，只需证明
{{< math >}}

\begin{align*} \\
f_{n} & = \sum_{i=0}^{n} (-1)^{n-i}\binom{ n }{ i } \sum_{j=0}^{i} \binom{ i }{ j } f_{j} \\
 & = \sum_{i=0}^{n} \sum_{j=0}^{i} (-1)^{n-i}\binom{ n }{ i } \binom{ i }{ j } f_{j} \\
 & = \sum_{i=0}^{n} \sum_{j=0}^{i} (-1)^{n-i}\binom{ n }{ j } \binom{ n-j }{ i-j } f_{j} \\
 & = \sum_{j=0}^{n}\binom{ n }{ j } f_{j} \sum_{i=j}^{n} (-1)^{n-i}\binom{ n-j }{ i-j }  \\
 & = \sum_{j=0}^{n} \binom{ n }{ j } f_{j}\cdot \left( \sum_{i=0}^{n-j} (-1)^{n+j-i}\binom{ n-j }{ i }  \right) \\
 & = \sum_{j=0}^{n} \binom{ n }{ j } f_{j}\cdot[n-j=0] \\
 & = f_{n}
\end{align*}

{{< /math >}}
这就证明了二项式反演。

因此对于第一个式子
{{< math >}}

\sum_{i=0}^{n} (-1)^{i}\binom{ n }{ i } \binom{ n+m-i }{ k-i } = \sum_{i=0}^{n} (-1)^{n-i}\binom{ n }{ i } \binom{ m+i }{ k-n+i } 

{{< /math >}}
令 {{< imath >}}g_{i}:=\binom{ m+i }{ k-n+i }{{< /imath >}}，那么上式就是 {{< imath >}}\sum_{i=0}^{n}(-1)^{n-i}\binom{ n }{ i }g_{i}{{< /imath >}}。

根据组合意义，显然有恒等式
{{< math >}}

g_{t} = \binom{ m+t }{ k-n+t } = \sum_{i=0}^{t} \binom{ t }{ i } \binom{ m }{ k-n+(t-i) } = \sum_{i=0}^{t} \binom{ t }{ i } \binom{ m }{ k-n+i } 

{{< /math >}}
因此我们直接取 {{< imath >}}f_{i}=\binom{ m }{ k-n+i }{{< /imath >}} 就可以得到
{{< math >}}

\sum_{i=0}^{n} \binom{ n }{ i } f_{i} = g_{n} \implies \sum_{i=0}^{n} (-1)^{n-i}\binom{ n }{ i } g_{i} = f_{n} = \binom{ m }{ k } 

{{< /math >}}
对于
{{< math >}}

\sum_{i=0}^{n} \binom{ k }{ i } D_{n-i} = \sum_{j=0}^{n-k} (-1)^{j}\binom{ n-k }{ j } (n-j)!

{{< /math >}}
似乎构造比较复杂，暂时搁置这个思路(


## Problem 2

**(1)**

有多少种方法可以从 {{< imath >}}n{{< /imath >}} 个元素的序列中选择 {{< imath >}}k{{< /imath >}} 个非连续的元素？

**解**

设从 {{< imath >}}n{{< /imath >}} 个元素的序列中选择 {{< imath >}}k{{< /imath >}} 个元素的全体集合为 {{< imath >}}U{{< /imath >}}，{{< imath >}}A_i (1 \leq i \leq n-1){{< /imath >}} 表示元素 {{< imath >}}i{{< /imath >}} 和 {{< imath >}}i+1{{< /imath >}} 同时被选择的事件。我们需要计算 {{< imath >}}\left| U \setminus \bigcup_{i=1}^{n-1} A_i \right|{{< /imath >}}，即选择 {{< imath >}}k{{< /imath >}} 个非连续元素的方案数。

首先，{{< imath >}}|U| = \binom{n}{k}{{< /imath >}}，表示从 {{< imath >}}n{{< /imath >}} 个元素中选择 {{< imath >}}k{{< /imath >}} 个元素的总方案数。对于每个 {{< imath >}}A_i{{< /imath >}}，表示元素 {{< imath >}}i{{< /imath >}} 和 {{< imath >}}i+1{{< /imath >}} 都被选中，剩余的 {{< imath >}}k-2{{< /imath >}} 个元素从除 {{< imath >}}i{{< /imath >}} 和 {{< imath >}}i+1{{< /imath >}} 外的 {{< imath >}}n-2{{< /imath >}} 个元素中选择，因此 {{< imath >}}|A_i| = \binom{n-2}{k-2}{{< /imath >}}。于是，单项和为：
{{< math >}}

\sum_{i=1}^{n-1} |A_i| = (n-1) \binom{n-2}{k-2}.

{{< /math >}}

对于二重交集 {{< imath >}}A_i \cap A_j (1 \leq i < j \leq n-1){{< /imath >}}，我们需考虑 {{< imath >}}i{{< /imath >}} 和 {{< imath >}}j{{< /imath >}} 的相对位置：
- 若 {{< imath >}}j = i+1{{< /imath >}}，则 {{< imath >}}A_i \cap A_{i+1}{{< /imath >}} 表示 {{< imath >}}i, i+1, i+2{{< /imath >}} 都被选中，共占用 3 个位置，剩余 {{< imath >}}k-3{{< /imath >}} 个元素从 {{< imath >}}n-3{{< /imath >}} 个位置中选，方案数为 {{< imath >}}\binom{n-3}{k-3}{{< /imath >}}。这样的 {{< imath >}}(i, i+1){{< /imath >}} 对有 {{< imath >}}n-2{{< /imath >}} 种。
- 若 {{< imath >}}j > i+1{{< /imath >}}，则 {{< imath >}}A_i \cap A_j{{< /imath >}} 表示选中 {{< imath >}}i, i+1, j, j+1{{< /imath >}} 四个元素，剩余 {{< imath >}}k-4{{< /imath >}} 个元素从 {{< imath >}}n-4{{< /imath >}} 个位置中选，方案数为 {{< imath >}}\binom{n-4}{k-4}{{< /imath >}}。这样的 {{< imath >}}(i, j){{< /imath >}} 对有 {{< imath >}}\binom{n-2}{2}{{< /imath >}} 种（任意选两个不连续的 {{< imath >}}A_i{{< /imath >}}）。

因此，二重交集的和为：
{{< math >}}

\sum_{1 \leq i < j \leq n-1} |A_i \cap A_j| = (n-2) \binom{n-3}{k-3} + \binom{n-2}{2} \binom{n-4}{k-4}.

{{< /math >}}

对于 {{< imath >}}m{{< /imath >}} 重交集 {{< imath >}}\bigcap_{j=1}^{m} A_{i_j}{{< /imath >}}，其中 {{< imath >}}1 \leq i_1 < i_2 < \dots < i_m \leq n-1{{< /imath >}}，{{< imath >}}m \leq \lfloor k/2 \rfloor{{< /imath >}}，我们需要计算 {{< imath >}}m{{< /imath >}} 个 {{< imath >}}A_{i_j}{{< /imath >}} 的交集。假设这 {{< imath >}}m{{< /imath >}} 个 {{< imath >}}A_{i_j}{{< /imath >}} 形成 {{< imath >}}j{{< /imath >}} 个连通块（即连续的 {{< imath >}}A_i{{< /imath >}} 序列），则：
- 连通块的个数 {{< imath >}}j{{< /imath >}} 满足 {{< imath >}}1 \leq j \leq m{{< /imath >}}。
- 将 {{< imath >}}m{{< /imath >}} 个 {{< imath >}}A_i{{< /imath >}} 分成 {{< imath >}}j{{< /imath >}} 个连通块的方案数为 {{< imath >}}\binom{m-1}{j-1}{{< /imath >}}（基于分割 {{< imath >}}m{{< /imath >}} 个元素为 {{< imath >}}j{{< /imath >}} 个非空有序子集的组合数）。
- 选择 {{< imath >}}j{{< /imath >}} 个连通块在 {{< imath >}}n-m{{< /imath >}} 个可能位置（考虑 {{< imath >}}m{{< /imath >}} 个 {{< imath >}}A_i{{< /imath >}} 占用 {{< imath >}}m{{< /imath >}} 个位置后剩余的间隔）的方案数为 {{< imath >}}\binom{n-m}{j}{{< /imath >}}。
- 每个连通块占用至少 2 个元素（一个 {{< imath >}}A_i{{< /imath >}} 包含 2 个元素，连续的 {{< imath >}}A_i{{< /imath >}} 共享元素），总共占用 {{< imath >}}m+j{{< /imath >}} 个元素（{{< imath >}}m{{< /imath >}} 个 {{< imath >}}A_i{{< /imath >}} 贡献 {{< imath >}}m{{< /imath >}} 对元素，每增加一个块边界增加一个元素）。剩余的 {{< imath >}}k-(m+j){{< /imath >}} 个元素从 {{< imath >}}n-(m+j){{< /imath >}} 个位置中选，方案数为 {{< imath >}}\binom{n-m-j}{k-m-j}{{< /imath >}}。

因此，{{< imath >}}m{{< /imath >}} 重交集的和为：
{{< math >}}

\sum_{1 \leq i_1 < i_2 < \dots < i_m \leq n-1} \left| \bigcap_{j=1}^{m} A_{i_j} \right| = \sum_{j=1}^{m} \binom{m-1}{j-1} \binom{n-m}{j} \binom{n-m-j}{k-m-j}.

{{< /math >}}

根据容斥原理，选择 {{< imath >}}k{{< /imath >}} 个非连续元素的方案数为：
{{< math >}}

\left| U \setminus \bigcup_{i=1}^{n-1} A_i \right| = \binom{n}{k} + \sum_{m=1}^{\lfloor k/2 \rfloor} (-1)^m \sum_{j=1}^{m} \binom{m-1}{j-1} \binom{n-m}{j} \binom{n-m-j}{k-m-j}.

{{< /math >}}
虽然这个式子较难化简，但是直接从组合意义考虑，可以得到上述表达式应该与此闭合形式等价
{{< math >}}

\binom{ n-k+1 }{ k } 

{{< /math >}}
**(2)**

有多少种方法可以从 {{< imath >}}n{{< /imath >}} 个元素的循环排列中选择 {{< imath >}}k{{< /imath >}} 个非连续的元素？

**解**

设从 {{< imath >}}n{{< /imath >}} 个元素的循环排列中选择 {{< imath >}}k{{< /imath >}} 个元素的全体集合为 {{< imath >}}U{{< /imath >}}，{{< imath >}}A_i (1 \leq i \leq n){{< /imath >}} 表示元素 {{< imath >}}i{{< /imath >}} 和 {{< imath >}}i+1{{< /imath >}} (模 {{< imath >}}n{{< /imath >}}) 同时被选择的事件。我们需要计算 {{< imath >}}\left| U \setminus \bigcup_{i=1}^{n} A_i \right|{{< /imath >}}，即选择 {{< imath >}}k{{< /imath >}} 个非连续元素的方案数。

首先，{{< imath >}}|U| = \binom{n}{k}{{< /imath >}}，表示从 {{< imath >}}n{{< /imath >}} 个元素中选择 {{< imath >}}k{{< /imath >}} 个元素的总方案数。对于每个 {{< imath >}}A_i{{< /imath >}}，表示元素 {{< imath >}}i{{< /imath >}} 和 {{< imath >}}i+1{{< /imath >}} 都被选中，剩余的 {{< imath >}}k-2{{< /imath >}} 个元素从除 {{< imath >}}i{{< /imath >}} 和 {{< imath >}}i+1{{< /imath >}} 外的 {{< imath >}}n-2{{< /imath >}} 个元素中选择，因此 {{< imath >}}|A_i| = \binom{n-2}{k-2}{{< /imath >}}。于是，单项和为：
{{< math >}}

\sum_{i=1}^{n} |A_i| = n \binom{n-2}{k-2}.

{{< /math >}}

对于二重交集 {{< imath >}}A_i \cap A_j (1 \leq i < j \leq n){{< /imath >}}，我们需考虑 {{< imath >}}i{{< /imath >}} 和 {{< imath >}}j{{< /imath >}} 的相对位置：
- 若 {{< imath >}}|i - j| \equiv 1 \pmod{n}{{< /imath >}}，则 {{< imath >}}A_i \cap A_{i+1}{{< /imath >}} 表示 {{< imath >}}i, i+1, i+2{{< /imath >}} 都被选中，共占用 3 个位置，剩余 {{< imath >}}k-3{{< /imath >}} 个元素从 {{< imath >}}n-3{{< /imath >}} 个位置中选，方案数为 {{< imath >}}\binom{n-3}{k-3}{{< /imath >}}。这样的相邻对有 {{< imath >}}n{{< /imath >}} 种。
- 若 {{< imath >}}|i - j| \not\equiv 1 \pmod{n}{{< /imath >}} 且 {{< imath >}}|i - j| \not\equiv n-1 \pmod{n}{{< /imath >}}（即非相邻），则 {{< imath >}}A_i \cap A_j{{< /imath >}} 表示选中 {{< imath >}}i, i+1, j, j+1{{< /imath >}} 四个元素，剩余 {{< imath >}}k-4{{< /imath >}} 个元素从 {{< imath >}}n-4{{< /imath >}} 个位置中选，方案数为 {{< imath >}}\binom{n-4}{k-4}{{< /imath >}}。这样的对有 {{< imath >}}\binom{n}{2} - n{{< /imath >}} 种。

因此，二重交集的和为：
{{< math >}}

\sum_{1 \leq i < j \leq n} |A_i \cap A_j| = n \binom{n-3}{k-3} + \left( \binom{n}{2} - n \right) \binom{n-4}{k-4}.

{{< /math >}}

对于 {{< imath >}}m{{< /imath >}} 重交集 {{< imath >}}\bigcap_{j=1}^{m} A_{i_j}{{< /imath >}}，其中 {{< imath >}}1 \leq i_1 < i_2 < \dots < i_m \leq n{{< /imath >}}，{{< imath >}}m \leq \lfloor k/2 \rfloor{{< /imath >}}，我们需要计算 {{< imath >}}m{{< /imath >}} 个 {{< imath >}}A_{i_j}{{< /imath >}} 的交集。假设这 {{< imath >}}m{{< /imath >}} 个 {{< imath >}}A_{i_j}{{< /imath >}} 形成 {{< imath >}}j{{< /imath >}} 个连通块（即连续的 {{< imath >}}A_i{{< /imath >}} 序列），则：
- 连通块的个数 {{< imath >}}j{{< /imath >}} 满足 {{< imath >}}1 \leq j \leq m{{< /imath >}}。
- 将 {{< imath >}}m{{< /imath >}} 个 {{< imath >}}A_i{{< /imath >}} 分成 {{< imath >}}j{{< /imath >}} 个连通块的有序方案数为 {{< imath >}}\binom{m-1}{j-1}{{< /imath >}}。
- 由于循环排列，分布剩余间隔的方案数为 {{< imath >}}\binom{n-m-1}{j-1}{{< /imath >}}，并乘以 {{< imath >}}\frac{n}{j}{{< /imath >}} 以调整循环计数至标签位置。
- 每个连通块占用至少 2 个元素，总共占用 {{< imath >}}m + j{{< /imath >}} 个元素。剩余的 {{< imath >}}k - (m + j){{< /imath >}} 个元素从 {{< imath >}}n - (m + j){{< /imath >}} 个位置中选，方案数为 {{< imath >}}\binom{n - m - j}{k - m - j}{{< /imath >}}。

因此，{{< imath >}}m{{< /imath >}} 重交集的和为：
{{< math >}}

\sum_{1 \leq i_1 < i_2 < \dots < i_m \leq n} \left| \bigcap_{j=1}^{m} A_{i_j} \right| = \sum_{j=1}^{m} \frac{n}{j} \binom{m-1}{j-1} \binom{n-m-1}{j-1} \binom{n-m-j}{k-m-j}.

{{< /math >}}

根据容斥原理，选择 {{< imath >}}k{{< /imath >}} 个非连续元素的方案数为：
{{< math >}}

\left| U \setminus \bigcup_{i=1}^{n} A_i \right| = \binom{n}{k} + \sum_{m=1}^{\lfloor k / 2 \rfloor } (-1)^{m}\sum_{j=1}^{m} \frac{n}{j} \binom{ m-1 }{ j-1 } \binom{ n-m-1 }{ j-1 } \binom{ n-m-j }{ k-m-j }.

{{< /math >}}

直接从组合意义考虑，上述表达式应该与此闭合形式等价（但是我还是不会化简😭）
{{< math >}}

\binom{n - k}{k} + \binom{n - k - 1}{k - 1}

{{< /math >}}

**(3)**

假设我们希望将 {{< imath >}}n{{< /imath >}} 对夫妇安排在一张桌子周围，其中男性和女性交替排列，并且每位女性与她的丈夫不相邻。认为通过座位位置的任何旋转得到的安排是相同的。证明安排的数量为：
{{< math >}}

(n-1)!\sum_{k=0}^{n} (-1)^{k} \dfrac{2n}{2n-k}\binom{ 2n-k }{ k } (n-k)!

{{< /math >}}
**解**

设全体排列事件的集合为 {{< imath >}}U{{< /imath >}}，事件 {{< imath >}}A_{i}{{< /imath >}} 表示第 {{< imath >}}i{{< /imath >}} 对夫妇相邻。我们需要计算 {{< imath >}}\left| U\setminus \bigcup_{i=1}^{n}A_{i} \right|{{< /imath >}}，即每对夫妇都不相邻的方案数。

首先全集 {{< imath >}}\left| U \right|= \frac{1}{n}\cdot n!\cdot n! = n!(n-1)!{{< /imath >}}。对于每个事件 {{< imath >}}A_{i}{{< /imath >}}，加上圆排列的对称性，可以看出只有一个点被固定了位置，同时一对夫妻的相对位置有两种可能，所以 {{< imath >}}\left| A_{i} \right|=2(n-1)!\cdot(n-1)!{{< /imath >}}，从而 {{< imath >}}\sum_{i=1}^{n}\left| A_{i} \right|=2n(n-1)!(n-1)!{{< /imath >}}。

对于 {{< imath >}}m{{< /imath >}} 重交集 {{< imath >}}\bigcap_{j=1}^{m} A_{i_j}{{< /imath >}}，其中 {{< imath >}}1 \leq i_1 < i_2 < \dots < i_m \leq n{{< /imath >}}，{{< imath >}}m \leq n{{< /imath >}}，我们需要计算 {{< imath >}}m{{< /imath >}} 个 {{< imath >}}A_{i_j}{{< /imath >}} 的交集。考虑座位位置的选择。将这 {{< imath >}}m{{< /imath >}} 对特定的夫妇每个视为一个块，每个块占用两个连续的座位。在 {{< imath >}}2n{{< /imath >}} 个座位的循环排列中，选择 {{< imath >}}m{{< /imath >}} 个不相重叠的连续座位对的方案数为 {{< imath >}}\dfrac{2n}{2n-m} \dbinom{2n-m}{m}{{< /imath >}}（组合意义？）。

然后，将这 {{< imath >}}m{{< /imath >}} 对夫妇分配到 {{< imath >}}m{{< /imath >}} 个块中的方案数为 {{< imath >}}m!{{< /imath >}}。对于整体的男女性别交替排列，有两种全局方向。对于每个方向，每个块中夫妇的排列由性别位置决定，仅有一种方式。剩余 {{< imath >}}n-m{{< /imath >}} 名男性和 {{< imath >}}n-m{{< /imath >}} 名女性分别安排到剩余的男性和女性座位中的方案数为 {{< imath >}}(n-m)! \cdot (n-m)!{{< /imath >}}。上述计算考虑了固定座位时的总数，随后除以 {{< imath >}}2n{{< /imath >}} 以计入旋转等价。

因此，{{< imath >}}\left| \bigcap_{j=1}^{m} A_{i_j} \right| = \dfrac{2}{2n-m} \dbinom{2n-m}{m} m! (n-m)! (n-m)!{{< /imath >}}。于是，{{< imath >}}m{{< /imath >}} 重交集的和为：
{{< math >}}

\sum_{1 \leq i_1 < \dots < i_m \leq n} \left| \bigcap_{j=1}^{m} A_{i_j} \right| = \dbinom{n}{m} \dfrac{2}{2n-m} \dbinom{2n-m}{m} m! (n-m)! (n-m)! = \dfrac{2}{2n-m} \dbinom{2n-m}{m} n! (n-m)! .

{{< /math >}}

根据容斥原理，每对夫妇都不相邻的方案数为：
{{< math >}}

\left| U \setminus \bigcup_{i=1}^{n} A_i \right| = \sum_{m=0}^{n} (-1)^{m} \dfrac{2}{2n-m} \dbinom{2n-m}{m} n! (n-m)! = (n-1)! \sum_{k=0}^{n} (-1)^{k} \dfrac{2n}{2n-k} \dbinom{2n-k}{k} (n-k)! .

{{< /math >}}

## Problem 3

**(1)**

假设 {{< imath >}}f,g,h{{< /imath >}} 都是数论函数，满足
{{< math >}}

g(n) = \sum_{d|n}df(d), \quad h(n) = \sum_{d|n}f(d)

{{< /math >}}
证明
{{< math >}}

h(n) = \dfrac{1}{n} \sum_{d|n} \varphi(n/d)g(d)

{{< /math >}}
**证**

我们讲 {{< imath >}}g(d){{< /imath >}} 带入目标表达式，得到
{{< math >}}

\begin{align*}
h(n) & = \dfrac{1}{n} \sum_{d|n}\varphi\left( \dfrac{n}{d} \right)\left( \sum_{e|d}ef(e) \right) \\
 & = \dfrac{1}{n} \sum_{e|d, d|n}\varphi\left( \dfrac{n}{d} \right)ef(e) \\
 & \xlongequal{d=ek} \dfrac{1}{n}\sum_{e|n}\sum_{k|(n / e)} \varphi\left( \dfrac{n}{ek} \right)ef(e) \\
 & = \dfrac{1}{n}\sum_{e|n}ef(e) \sum_{k|(n / e)} \varphi\left( \dfrac{n / e}{k} \right)
\end{align*}

{{< /math >}}
由于 {{< imath >}}\sum_{k|m}\varphi(k)=m{{< /imath >}}，因此
{{< math >}}

\sum_{k|(n / e)} \varphi\left( \dfrac{n / e}{k} \right) = \dfrac{n}{e}

{{< /math >}}
带入得到
{{< math >}}

h(n) = \dfrac{1}{n}\sum_{e|n}ef(e) \cdot \dfrac{n}{e} = \sum_{e|n}f(e) = \sum_{d|n}f(d)

{{< /math >}}
得证！

**(2)**

希望用 {{< imath >}}q{{< /imath >}} 种颜色对一条由 {{< imath >}}n{{< /imath >}} 颗珠子组成的项链进行着色。确定 {{< imath >}}N_n{{< /imath >}}，即着色方案的数量，其中如果两种着色方案可以通过旋转互相得到，则认为它们是相同的。

同样地，可以将 {{< imath >}}N_n{{< /imath >}} 定义为在 {{< imath >}}[q]{{< /imath >}} 上的循环序列的数量，其中通过旋转得到的两个序列被认为是相同的。求 {{< imath >}}N_n{{< /imath >}} 。

（提示：设 {{< imath >}}M(d){{< /imath >}} 为长度为 {{< imath >}}d{{< /imath >}} 且非周期性的循环序列的数量。）

**解**

按照提示设出 {{< imath >}}M(d){{< /imath >}}，那么找项链最小的循环节，容易得到
{{< math >}}

N_{n} = \sum_{d|n} M(d)

{{< /math >}}
我们需要计算 {{< imath >}}M(d){{< /imath >}}。考虑普通序列和循环序列之间的关系。对于长度 {{< imath >}}n{{< /imath >}}，普通序列的总数为 {{< imath >}}q^{n}{{< /imath >}}，而每个最小周期为 {{< imath >}}d{{< /imath >}} 的循环序列对应 {{< imath >}}d{{< /imath >}} 中不同的表示，因此数量为 {{< imath >}}dM(d){{< /imath >}}，这就得到了
{{< math >}}

q^{n}= \sum_{d|n}dM(d)

{{< /math >}}
因此根据上一问的结论，我们就得到了
{{< math >}}

N_{n} = \dfrac{1}{n}\sum_{d|n}\varphi\left( \dfrac{d}{n} \right)q^{d}

{{< /math >}}

## Problem 4

考虑一个偏序集 {{< imath >}}\mathcal{P} = (P, \preccurlyeq){{< /imath >}}，其中
{{< math >}}

P = \{(a_1, a_2, a_3, a_4) : a_i \in [4]\}

{{< /math >}}
并且 {{< imath >}}(a_1, a_2, a_3, a_4) \preccurlyeq (b_1, b_2, b_3, b_4){{< /imath >}} 当且仅当对于所有 {{< imath >}}i{{< /imath >}} 都有 {{< imath >}}a_i \le b_i{{< /imath >}}。求满足 {{< imath >}}\mu(x, y) < 0{{< /imath >}} 的序对 {{< imath >}}x, y \in P{{< /imath >}} 的数量。

**解**

对于两个 {{< imath >}}x,y\in P{{< /imath >}}，根据讲义的 Lemma 4.24，莫比乌斯函数的积性，得到
{{< math >}}

\mu(x,y) = \prod_{i=1}^{4}\mu_{[4]}(x_{i},y_{i})

{{< /math >}}
对于一个 {{< imath >}}[4]{{< /imath >}} 的链，我们直接计算 {{< imath >}}\mu_{[4]}(a,b){{< /imath >}}：
- 如果 {{< imath >}}a \not\leq b{{< /imath >}}，那么 {{< imath >}}\mu_{[4]}(a,b)=0{{< /imath >}}。
- 如果 {{< imath >}}a=b{{< /imath >}}，那么 {{< imath >}}\mu_{[4]}(a,b)=1{{< /imath >}}。
- 如果 {{< imath >}}b=a+1{{< /imath >}}，那么 {{< imath >}}\mu_{[4]}(a,b)=-1{{< /imath >}}。
- 如果 {{< imath >}}b\geq a+2{{< /imath >}}，那么 {{< imath >}}\mu_{[4]}(a,b)=-\sum_{k=a}^{b-1}\mu_{[4]}(a,k)=0{{< /imath >}}。

因此对于 {{< imath >}}x,y\in P{{< /imath >}}，{{< imath >}}\mu(x,y)\neq 0{{< /imath >}} 当且进行对于所有 {{< imath >}}i{{< /imath >}} 满足 {{< imath >}}y_{i}-x_{i}\leq 1{{< /imath >}}。定义 {{< imath >}}k{{< /imath >}} 为 {{< imath >}}y_{i}=x_{i}+1{{< /imath >}} 的下标数量，其余 {{< imath >}}y_{i}=x_{i}{{< /imath >}}，于是就有
{{< math >}}

\mu(x,y) = (-1)^{k}

{{< /math >}}
小于 {{< imath >}}0{{< /imath >}} 当且仅当 {{< imath >}}k=1,3{{< /imath >}}。

我们分开计算 {{< imath >}}k=1,3{{< /imath >}} 的序对数量：
- {{< imath >}}k=1{{< /imath >}}，根据组合意义可以得到总数为 {{< imath >}}\binom{ 4 }{ 1 }\times 3^{1} \times 4^{3}=768{{< /imath >}}。
- {{< imath >}}k=3{{< /imath >}}，总数为 {{< imath >}}\binom{ 4 }{ 3 }\times 3^{3} \times 4=432{{< /imath >}}。

因此总数为 {{< imath >}}768+432=1200{{< /imath >}}。

## Problem 5

挑选两个在 {{< imath >}}[100]{{< /imath >}} 范围内均匀、独立随机的数字 {{< imath >}}a{{< /imath >}} 和 {{< imath >}}b{{< /imath >}}。在 {{< imath >}}[100]{{< /imath >}} 上的偏序关系定义为整除关系，求 {{< imath >}}\mu(a, b) = -1{{< /imath >}} 的概率。

**解**

**解**

我们考虑直接算出所有满足条件的 {{< imath >}}(a,b){{< /imath >}} 的总数。对于 {{< imath >}}\mu(a,b){{< /imath >}}，分类讨论：
- 如果 {{< imath >}}a \not\mid b{{< /imath >}}，那么 {{< imath >}}\mu(a,b)=0{{< /imath >}}。
- 如果 {{< imath >}}a=b{{< /imath >}}，那么 {{< imath >}}\mu(a,b)=1{{< /imath >}}。
- 如果 {{< imath >}}b=ka{{< /imath >}}（{{< imath >}}k \geq 2{{< /imath >}}），那么 {{< imath >}}\mu(a,b)=\mu(1,k){{< /imath >}}，其中 {{< imath >}}\mu(1,k)=(-1)^{\omega(k)}{{< /imath >}} 当 {{< imath >}}k{{< /imath >}} 无平方因子，否则 {{< imath >}}\mu(1,k)=0{{< /imath >}}。

因此 {{< imath >}}\mu(a,b)=-1{{< /imath >}} 当且仅当 {{< imath >}}k{{< /imath >}} 无平方因子且 {{< imath >}}\omega(k){{< /imath >}} 为奇数。定义 {{< imath >}}m{{< /imath >}} 为 {{< imath >}}\omega(k){{< /imath >}} 的奇数值，其可能取值 {{< imath >}}m=1,3{{< /imath >}}（因 {{< imath >}}k \leq 100{{< /imath >}}，最大 {{< imath >}}m=3{{< /imath >}}）。

我们分开计算 {{< imath >}}m=1,3{{< /imath >}} 的序对数量：
- {{< imath >}}m=1{{< /imath >}}（{{< imath >}}k{{< /imath >}} 为素数），总数为 {{< imath >}}\sum_{p \leq 100} \lfloor 100/p \rfloor =171{{< /imath >}}。
- {{< imath >}}m=3{{< /imath >}}（{{< imath >}}k{{< /imath >}} 为三个不同素数的乘积），此类 {{< imath >}}k=30,42,66,70,78{{< /imath >}}，总数为 {{< imath >}}\lfloor 100/30 \rfloor + \lfloor 100/42 \rfloor + \lfloor 100/66 \rfloor + \lfloor 100/70 \rfloor + \lfloor 100/78 \rfloor =3+2+1+1+1=8{{< /imath >}}。

因此总数为 {{< imath >}}171+8=179{{< /imath >}}，于是
{{< math >}}

\mathbb{P}(\mu(a,b)=-1) = \dfrac{179}{100^{2}} = \dfrac{179}{10000}.

{{< /math >}}
## Problem 6

设 {{< imath >}}a_1, a_2, \dots, a_n{{< /imath >}} 是一些实数，它们的绝对值都满足 {{< imath >}}|a_i| \ge 1{{< /imath >}}。考虑所有 {{< imath >}}2^n{{< /imath >}} 种线性组合 {{< imath >}}\sum_{i=1}^{n} \epsilon_i \cdot a_i{{< /imath >}}，其中每个 {{< imath >}}\epsilon_i{{< /imath >}} 可以取值 {{< imath >}}\{-1, +1\}{{< /imath >}}。请证明，这些和中落在任意区间 {{< imath >}}(x-1, x+1){{< /imath >}} 内的数量**至多**为 {{< imath >}}\binom{n}{\lfloor n/2 \rfloor}{{< /imath >}}。

**证**

我们稍微转化一下题目，令 {{< imath >}}b_{i}=2a_{i}{{< /imath >}}，取 {{< imath >}}\{ b_{n} \}{{< /imath >}} 的幂集 {{< imath >}}\mathcal{P}{{< /imath >}}，对于 {{< imath >}}S\in \mathcal{P}{{< /imath >}}，{{< imath >}}S{{< /imath >}} 中所有元素之和显然可以有一组 {{< imath >}}\sum_{i=1}^{n}\epsilon_{i}\cdot a_{i}{{< /imath >}} 平移得到，就这样 {{< imath >}}\mathcal{P}{{< /imath >}} 可以和 {{< imath >}}2^{n}{{< /imath >}} 中 {{< imath >}}a_{i}{{< /imath >}} 的线性组合一一对应。并且我们只需要考虑落在任意区间中的数量，所以平移操作并不会造成影响，于是我们的问题就转化成了 {{< imath >}}\mathcal{P}{{< /imath >}} 中集合的元素之和落在任意区间 {{< imath >}}(x-1,x+1){{< /imath >}} 内的集合数量至多位 {{< imath >}}\binom{ n }{ \lfloor n / 2 \rfloor }{{< /imath >}}。

假设集合 {{< imath >}}S{{< /imath >}} 是一个满足条件的集合。由于 {{< imath >}}\left| b_{i} \right|=2\left| a_{i} \right|>2{{< /imath >}}，因此在 {{< imath >}}S{{< /imath >}} 的基础上任意添加一个原来不包含的元素，至少会导致元素之和变化 {{< imath >}}2{{< /imath >}}，从而一定不会落在 {{< imath >}}(x-1,x+1){{< /imath >}} 中。这说明了若 {{< imath >}}\sum_{S}\in(x-1,x+1){{< /imath >}}，那么任意 {{< imath >}}S'{{< /imath >}} 满足 {{< imath >}}S\subset S'{{< /imath >}}，都有 {{< imath >}}\sum_{S'}\not\in (x-1,x+1){{< /imath >}}。

因此我们直接考虑偏序集 {{< imath >}}(\mathcal{P},\subseteq){{< /imath >}}。根据上面的分析，显然元素之和落在 {{< imath >}}(x-1,x+1){{< /imath >}} 的所有集合一定是一个反链。直接利用 Sperner 定理，得到此时反链的数量至多为 {{< imath >}}\binom{ n }{ \lfloor n / 2 \rfloor }{{< /imath >}}，因此满足条件的集合数量也至多为 {{< imath >}}\binom{ n }{ \lfloor n / 2 \rfloor }{{< /imath >}}。

