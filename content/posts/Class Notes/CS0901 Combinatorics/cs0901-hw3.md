---
tags:
- learning
- math
- combinatorics
- homework
discipline: mathematics
publish: true
date: '2025-10-05T23:00:00+08:00'
title: CS0901 HW3
categories:
- course-note
---
## Problem 1

证明
{{< math >}}

\begin{align*}
\sum_{i=0}^{n} (-1)^{i}\binom{ n }{ i } \binom{ n+m-i }{ k-i } = \binom{ m }{ k }  \\
\sum_{i=0}^{n} \binom{ k }{ i } D_{n-i} = \sum_{j=0}^{n-k} (-1)^{j}\binom{ n-k }{ j } (n-j)!
\end{align*}

{{< /math >}}
**证 1**

对于第一个式子，我们考虑组合意义。设有 {{< imath >}}A,B{{< /imath >}} 两个集合，分别包含 {{< imath >}}n{{< /imath >}} 和 {{< imath >}}m{{< /imath >}} 个元素，总共 {{< imath >}}n+m{{< /imath >}} 个元素。我们希望从集合 {{< imath >}}B{{< /imath >}} 中恰好选择 {{< imath >}}k{{< /imath >}} 个元素。我们可以通过容斥原理的补集形式求解，定义事件 {{< imath >}}A_{i}{{< /imath >}} 为所选的 {{< imath >}}k{{< /imath >}} 个元素中至少包含 {{< imath >}}i{{< /imath >}} 个来自 {{< imath >}}A{{< /imath >}} 的元素，那么我们需要求解的事件集合为 {{< imath >}}U\setminus\bigcup_{i\leq n}A_{i}{{< /imath >}}，并且
{{< math >}}

\left| A_{i} \right| = \binom{ n }{ i } \binom{ n+m-i }{ k-i } 

{{< /math >}}
因此根据容斥原理，就可以得到
{{< math >}}

\left| U\setminus \bigcup_{i\leq n}A_{i} \right| = \sum_{i=0}^{n} (-1)^{i}\binom{ n }{ i } \binom{ n+m-i }{ k-i } = \binom{ m }{ k }  

{{< /math >}}

对于第二个式子，同样考虑组合意义。我们可以假定 {{< imath >}}n\geq k{{< /imath >}}，否则两侧均为零。设有 {{< imath >}}n{{< /imath >}} 个元素的排列，分成 {{< imath >}}A{{< /imath >}} 和 {{< imath >}}B{{< /imath >}} 两部分，分别包含 {{< imath >}}k{{< /imath >}} 和 {{< imath >}}n-k{{< /imath >}} 个元素。左侧所有枚举所有 {{< imath >}}A{{< /imath >}} 中元素的组合固定，剩下的进行错排，可以表示 {{< imath >}}A{{< /imath >}} 中元素任意，{{< imath >}}B{{< /imath >}} 中元素必须为错排的方案数。我们同样考虑通过容斥原理的补集形式来求解。右侧我们定义事件 {{< imath >}}B_{i}{{< /imath >}} 表示 {{< imath >}}B{{< /imath >}} 中至少有 {{< imath >}}i{{< /imath >}} 个元素不是错排（值等于自己的编号），剩下的数随意，于是 {{< imath >}}\left| B_{i} \right|=\binom{ n-k }{ i }(n-i)!{{< /imath >}}。同时我们需要求解的事件集合为 {{< imath >}}U\setminus\bigcup_{i=1}^{n-k}B_{i}{{< /imath >}}，因此根据容斥原理可以得到
{{< math >}}

\left| U\setminus \bigcup_{j=1}^{n-k}B_{j} \right| = \sum_{i=0}^{n} \binom{ k }{ i } D_{n-i} = \sum_{j=0}^{n-k} (-1)^{j}\binom{ n-k }{ j } (n-j)!

{{< /math >}}
**证 2**：

这两个式子和二项反演都有一定的类似之处。
{{< math >}}

g_{n} = \sum_{i=0}^{n} \binom{ n }{ i } f_{i} \implies f_{n} = \sum_{i=0}^{n} (-1)^{n-i}\binom{ n }{ i } g_{i}

{{< /math >}}
我们直接证明二项反演。

将 {{< imath >}}g_{i}{{< /imath >}} 的表达式带入要证明的式子，只需证明
{{< math >}}

\begin{align*} \\
f_{n} & = \sum_{i=0}^{n} (-1)^{n-i}\binom{ n }{ i } \sum_{j=0}^{i} \binom{ i }{ j } f_{j} \\
 & = \sum_{i=0}^{n} \sum_{j=0}^{i} (-1)^{n-i}\binom{ n }{ i } \binom{ i }{ j } f_{j} \\
 & = \sum_{i=0}^{n} \sum_{j=0}^{i} (-1)^{n-i}\binom{ n }{ j } \binom{ n-j }{ i-j } f_{j} \\
 & = \sum_{j=0}^{n}\binom{ n }{ j } f_{j} \sum_{i=j}^{n} (-1)^{n-i}\binom{ n-j }{ i-j }  \\
 & = \sum_{j=0}^{n} \binom{ n }{ j } f_{j}\cdot \left( \sum_{i=0}^{n-j} (-1)^{n+j-i}\binom{ n-j }{ i }  \right) \\
 & = \sum_{j=0}^{n} \binom{ n }{ j } f_{j}\cdot[n-j=0] \\
 & = f_{n}
\end{align*}

{{< /math >}}
这就证明了二项式反演。

因此对于第一个式子
{{< math >}}

\sum_{i=0}^{n} (-1)^{i}\binom{ n }{ i } \binom{ n+m-i }{ k-i } = \sum_{i=0}^{n} (-1)^{n-i}\binom{ n }{ i } \binom{ m+i }{ k-n+i } 

{{< /math >}}
令 {{< imath >}}g_{i}:=\binom{ m+i }{ k-n+i }{{< /imath >}}，那么上式就是 {{< imath >}}\sum_{i=0}^{n}(-1)^{n-i}\binom{ n }{ i }g_{i}{{< /imath >}}。

根据组合意义，显然有恒等式
{{< math >}}

g_{t} = \binom{ m+t }{ k-n+t } = \sum_{i=0}^{t} \binom{ t }{ i } \binom{ m }{ k-n+(t-i) } = \sum_{i=0}^{t} \binom{ t }{ i } \binom{ m }{ k-n+i } 

{{< /math >}}
因此我们直接取 {{< imath >}}f_{i}=\binom{ m }{ k-n+i }{{< /imath >}} 就可以得到
{{< math >}}

\sum_{i=0}^{n} \binom{ n }{ i } f_{i} = g_{n} \implies \sum_{i=0}^{n} (-1)^{n-i}\binom{ n }{ i } g_{i} = f_{n} = \binom{ m }{ k } 

{{< /math >}}
对于
{{< math >}}

\sum_{i=0}^{n} \binom{ k }{ i } D_{n-i} = \sum_{j=0}^{n-k} (-1)^{j}\binom{ n-k }{ j } (n-j)!

{{< /math >}}
似乎构造比较复杂，暂时搁置这个思路(


## Problem 2

**(1)**

有多少种方法可以从 {{< imath >}}n{{< /imath >}} 个元素的序列中选择 {{< imath >}}k{{< /imath >}} 个非连续的元素？

**解**

设从 {{< imath >}}n{{< /imath >}} 个元素中选择 {{< imath >}}k{{< /imath >}} 个元素的全体集合为 {{< imath >}}U{{< /imath >}}，{{< imath >}}A_i{{< /imath >}} {{< imath >}}(1 \leq i \leq k-1){{< /imath >}} 表示选择的 {{< imath >}}k{{< /imath >}} 个数中第 {{< imath >}}i{{< /imath >}} 和 {{< imath >}}i+1{{< /imath >}} 个数同时被选中的事件。我们需要用容斥原理计算 {{< imath >}}\left| U \setminus \bigcup_{i=1}^{k-1} A_i \right|{{< /imath >}}。

**全集**：{{< imath >}}|U| = \binom{n}{k}{{< /imath >}}。

**单项和**：{{< imath >}}|A_i| = \binom{n-1}{k-1}{{< /imath >}}，因此 {{< math >}}
 \sum_{i=1}^{k-1} |A_i| = (k-1) \binom{n-1}{k-1} 
{{< /math >}}

**{{< imath >}}m{{< /imath >}} 重交集**：对于 {{< imath >}}1 \leq i_1 < i_2 < \cdots < i_m \leq k-1{{< /imath >}}，{{< imath >}}\bigcup_{j=1}^{m}A_{i_{j}}{{< /imath >}} 等价于从 {{< imath >}}n-m{{< /imath >}} 中选取 {{< imath >}}k-m{{< /imath >}} 个数，方案数为 {{< imath >}}\binom{ n-m }{ k-m }{{< /imath >}}。

因此
{{< math >}}

\sum_{S\in[n]\land \left| S \right| =m} \left( \bigcup_{i\in S}A_{i} \right) = \binom{ k-1 }{ m } \binom{ n-m }{ k-m } 

{{< /math >}}

由容斥原理
{{< math >}}

\left| U\setminus \bigcup_{i=1}^{k-1}A_{i} \right| = \sum_{m=0}^{k-1} (-1)^{m}\binom{ k-1 }{ m } \binom{ n-m }{ k-m } 

{{< /math >}}

通过组合意义，可以得到该式化简后等于 {{< math >}}
 \binom{n-k+1}{k} 
{{< /math >}}
**(2)**

有多少种方法可以从 {{< imath >}}n{{< /imath >}} 个元素的循环排列中选择 {{< imath >}}k{{< /imath >}} 个非连续的元素？

**解**

设从 {{< imath >}}n{{< /imath >}} 个元素的循环排列中选择 {{< imath >}}k{{< /imath >}} 个元素的全体集合为 {{< imath >}}U{{< /imath >}}，{{< imath >}}A_i{{< /imath >}} {{< imath >}}(1 \leq i \leq k){{< /imath >}} 表示选择的 {{< imath >}}k{{< /imath >}} 个数中第 {{< imath >}}i{{< /imath >}} 和第 {{< imath >}}i+1{{< /imath >}}（模 {{< imath >}}k{{< /imath >}}）个数在循环上相邻的事件。我们需要用容斥原理计算 {{< imath >}}\left| U \setminus \bigcup_{i=1}^{k} A_i \right|{{< /imath >}}。

**全集**：{{< imath >}}|U| = \binom{n}{k}{{< /imath >}}。

**单项和**：对于 {{< imath >}}1 \leq i \leq k-1{{< /imath >}}，{{< imath >}}|A_i| = \binom{n-1}{k-1}{{< /imath >}}；对于 {{< imath >}}A_k{{< /imath >}}（首尾相邻），{{< imath >}}|A_k| = \binom{n-2}{k-2}{{< /imath >}}，因此 {{< math >}}
 \sum_{i=1}^{k} |A_i| = (k-1) \binom{n-1}{k-1} + \binom{n-2}{k-2} 
{{< /math >}}

**{{< imath >}}m{{< /imath >}} 重交集**：对于 {{< imath >}}1 \leq i_1 < i_2 < \cdots < i_m \leq k{{< /imath >}}，若这些事件在循环上形成 {{< imath >}}c{{< /imath >}} 个连通段，则 {{< imath >}}\left|\bigcap_{j=1}^{m}A_{i_{j}}\right| = \binom{n-(m+c)}{k-(m+c)}{{< /imath >}}。

设 {{< imath >}}N_k(m,c){{< /imath >}} 为从 {{< imath >}}k{{< /imath >}} 个事件中选 {{< imath >}}m{{< /imath >}} 个形成恰好 {{< imath >}}c{{< /imath >}} 个连通段的方案数，则 {{< math >}}
 \sum_{1 \leq i_1 < \cdots < i_m \leq k} \left|\bigcap_{j=1}^{m}A_{i_{j}}\right| = \sum_{c=1}^{\min(m,k)} N_k(m,c) \binom{n-(m+c)}{k-(m+c)} 
{{< /math >}}

其中 {{< imath >}}N_k(m,c) = \frac{k}{m} \binom{m}{c} \binom{m-c}{c}{{< /imath >}}（将 {{< imath >}}m{{< /imath >}} 个事件在 {{< imath >}}k{{< /imath >}} 个位置的循环上分成 {{< imath >}}c{{< /imath >}} 个连通段）。

由容斥原理 {{< math >}}
 \left| U\setminus \bigcup_{i=1}^{k}A_{i} \right| = \sum_{m=0}^{\lfloor k/2 \rfloor} (-1)^{m} \sum_{c=1}^{m} N_k(m,c) \binom{n-(m+c)}{k-(m+c)} 
{{< /math >}}

通过组合意义，可以得到该式化简后等于 {{< math >}}
 \frac{n}{n-k}\binom{n-k}{k} 
{{< /math >}}

**组合意义**：从 {{< imath >}}n{{< /imath >}} 个位置的循环排列中选择 {{< imath >}}k{{< /imath >}} 个位置，使得任意两个选中位置不相邻的方案数。可通过将 {{< imath >}}k{{< /imath >}} 个选中位置和 {{< imath >}}n-k{{< /imath >}} 个未选中位置交替排列的方式理解此公式。

**(3)**

假设我们希望将 {{< imath >}}n{{< /imath >}} 对夫妇安排在一张圆桌周围，其中男性和女性交替排列，并且每位女性与她的丈夫不相邻。座位旋转视为相同。证明安排的数量为： {{< math >}}
 (n-1)!\sum_{k=0}^{n} (-1)^{k} \dfrac{2n}{2n-k}\binom{2n-k}{k} (n-k)! 
{{< /math >}}

**解**

设 {{< imath >}}A_i{{< /imath >}} 表示第 {{< imath >}}i{{< /imath >}} 对夫妇相邻的事件。

**全集**：男女交替排列，考虑旋转等价。固定一名男性的位置，其余 {{< imath >}}n-1{{< /imath >}} 名男性排列有 {{< imath >}}(n-1)!{{< /imath >}} 种，{{< imath >}}n{{< /imath >}} 名女性排列有 {{< imath >}}n!{{< /imath >}} 种，因此 {{< math >}}
 |U| = (n-1)! \cdot n! 
{{< /math >}}
**单项和**：将第 {{< imath >}}i{{< /imath >}} 对夫妇视为一个单元，该单元内部有 2 种排法（考虑男女交替约束）。剩余排列方式为 {{< imath >}}(n-1)! \cdot (n-1)!{{< /imath >}}，因此 {{< math >}}
 |A_i| = 2(n-1)!(n-1)!, \quad \sum_{i=1}^{n} |A_i| = 2n(n-1)!(n-1)! 
{{< /math >}}
**{{< imath >}}m{{< /imath >}} 重交集**：选定 {{< imath >}}m{{< /imath >}} 对夫妇 {{< imath >}}i_1, \ldots, i_m{{< /imath >}} 相邻。在圆桌的 {{< imath >}}2n{{< /imath >}} 个座位上选择 {{< imath >}}m{{< /imath >}} 个不重叠的相邻座位对，考虑循环对称性，方案数为 {{< imath >}}\frac{n}{n-m}\binom{2n-m}{m}{{< /imath >}}。

- 将 {{< imath >}}m{{< /imath >}} 对夫妇分配到这 {{< imath >}}m{{< /imath >}} 个座位对：{{< imath >}}m!{{< /imath >}}
- 每对夫妇内部排列：考虑男女交替的整体约束，共有 2 种全局配置
- 剩余 {{< imath >}}n-m{{< /imath >}} 对夫妇的男女各自排列：{{< imath >}}(n-m)! \times (n-m)!{{< /imath >}}

因此 {{< math >}}
 \left|\bigcap_{j=1}^{m} A_{i_j}\right| = \frac{2}{2n-m}\binom{2n-m}{m} m! (n-m)!^2 
{{< /math >}}

**{{< imath >}}m{{< /imath >}} 重交集和**： {{< math >}}
 \sum_{1 \leq i_1 < \cdots < i_m \leq n} \left|\bigcap_{j=1}^{m} A_{i_j}\right| = \binom{n}{m} \cdot \frac{2}{2n-m}\binom{2n-m}{m} m! (n-m)!^2 = \frac{2n!}{2n-m}\binom{2n-m}{m} (n-m)! 
{{< /math >}}

由容斥原理： {{< math >}}
 \left|U \setminus \bigcup_{i=1}^{n} A_i\right| = \sum_{k=0}^{n} (-1)^k \frac{2n!}{2n-k}\binom{2n-k}{k} (n-k)! = (n-1)!\sum_{k=0}^{n} (-1)^k \frac{2n}{2n-k}\binom{2n-k}{k} (n-k)! 
{{< /math >}}
## Problem 3

**(1)**

假设 {{< imath >}}f,g,h{{< /imath >}} 都是数论函数，满足
{{< math >}}

g(n) = \sum_{d|n}df(d), \quad h(n) = \sum_{d|n}f(d)

{{< /math >}}
证明
{{< math >}}

h(n) = \dfrac{1}{n} \sum_{d|n} \varphi(n/d)g(d)

{{< /math >}}
**证**

我们讲 {{< imath >}}g(d){{< /imath >}} 带入目标表达式，得到
{{< math >}}

\begin{align*}
h(n) & = \dfrac{1}{n} \sum_{d|n}\varphi\left( \dfrac{n}{d} \right)\left( \sum_{e|d}ef(e) \right) \\
 & = \dfrac{1}{n} \sum_{e|d, d|n}\varphi\left( \dfrac{n}{d} \right)ef(e) \\
 & \xlongequal{d=ek} \dfrac{1}{n}\sum_{e|n}\sum_{k|(n / e)} \varphi\left( \dfrac{n}{ek} \right)ef(e) \\
 & = \dfrac{1}{n}\sum_{e|n}ef(e) \sum_{k|(n / e)} \varphi\left( \dfrac{n / e}{k} \right)
\end{align*}

{{< /math >}}
由于 {{< imath >}}\sum_{k|m}\varphi(k)=m{{< /imath >}}，因此
{{< math >}}

\sum_{k|(n / e)} \varphi\left( \dfrac{n / e}{k} \right) = \dfrac{n}{e}

{{< /math >}}
带入得到
{{< math >}}

h(n) = \dfrac{1}{n}\sum_{e|n}ef(e) \cdot \dfrac{n}{e} = \sum_{e|n}f(e) = \sum_{d|n}f(d)

{{< /math >}}
得证！

**(2)**

希望用 {{< imath >}}q{{< /imath >}} 种颜色对一条由 {{< imath >}}n{{< /imath >}} 颗珠子组成的项链进行着色。确定 {{< imath >}}N_n{{< /imath >}}，即着色方案的数量，其中如果两种着色方案可以通过旋转互相得到，则认为它们是相同的。

同样地，可以将 {{< imath >}}N_n{{< /imath >}} 定义为在 {{< imath >}}[q]{{< /imath >}} 上的循环序列的数量，其中通过旋转得到的两个序列被认为是相同的。求 {{< imath >}}N_n{{< /imath >}} 。

（提示：设 {{< imath >}}M(d){{< /imath >}} 为长度为 {{< imath >}}d{{< /imath >}} 且非周期性的循环序列的数量。）

**解**

按照提示设出 {{< imath >}}M(d){{< /imath >}}，那么找项链最小的循环节，容易得到
{{< math >}}

N_{n} = \sum_{d|n} M(d)

{{< /math >}}
我们需要计算 {{< imath >}}M(d){{< /imath >}}。考虑普通序列和循环序列之间的关系。对于长度 {{< imath >}}n{{< /imath >}}，普通序列的总数为 {{< imath >}}q^{n}{{< /imath >}}，而每个最小周期为 {{< imath >}}d{{< /imath >}} 的循环序列对应 {{< imath >}}d{{< /imath >}} 中不同的表示，因此数量为 {{< imath >}}dM(d){{< /imath >}}，这就得到了
{{< math >}}

q^{n}= \sum_{d|n}dM(d)

{{< /math >}}
因此根据上一问的结论，我们就得到了
{{< math >}}

N_{n} = \dfrac{1}{n}\sum_{d|n}\varphi\left( \dfrac{d}{n} \right)q^{d}

{{< /math >}}

## Problem 4

考虑一个偏序集 {{< imath >}}\mathcal{P} = (P, \preccurlyeq){{< /imath >}}，其中
{{< math >}}

P = \{(a_1, a_2, a_3, a_4) : a_i \in [4]\}

{{< /math >}}
并且 {{< imath >}}(a_1, a_2, a_3, a_4) \preccurlyeq (b_1, b_2, b_3, b_4){{< /imath >}} 当且仅当对于所有 {{< imath >}}i{{< /imath >}} 都有 {{< imath >}}a_i \le b_i{{< /imath >}}。求满足 {{< imath >}}\mu(x, y) < 0{{< /imath >}} 的序对 {{< imath >}}x, y \in P{{< /imath >}} 的数量。

**解**

对于两个 {{< imath >}}x,y\in P{{< /imath >}}，根据讲义的 Lemma 4.24，莫比乌斯函数的积性，得到
{{< math >}}

\mu(x,y) = \prod_{i=1}^{4}\mu_{[4]}(x_{i},y_{i})

{{< /math >}}
对于一个 {{< imath >}}[4]{{< /imath >}} 的链，我们直接计算 {{< imath >}}\mu_{[4]}(a,b){{< /imath >}}：
- 如果 {{< imath >}}a \not\leq b{{< /imath >}}，那么 {{< imath >}}\mu_{[4]}(a,b)=0{{< /imath >}}。
- 如果 {{< imath >}}a=b{{< /imath >}}，那么 {{< imath >}}\mu_{[4]}(a,b)=1{{< /imath >}}。
- 如果 {{< imath >}}b=a+1{{< /imath >}}，那么 {{< imath >}}\mu_{[4]}(a,b)=-1{{< /imath >}}。
- 如果 {{< imath >}}b\geq a+2{{< /imath >}}，那么 {{< imath >}}\mu_{[4]}(a,b)=-\sum_{k=a}^{b-1}\mu_{[4]}(a,k)=0{{< /imath >}}。

因此对于 {{< imath >}}x,y\in P{{< /imath >}}，{{< imath >}}\mu(x,y)\neq 0{{< /imath >}} 当且进行对于所有 {{< imath >}}i{{< /imath >}} 满足 {{< imath >}}y_{i}-x_{i}\leq 1{{< /imath >}}。定义 {{< imath >}}k{{< /imath >}} 为 {{< imath >}}y_{i}=x_{i}+1{{< /imath >}} 的下标数量，其余 {{< imath >}}y_{i}=x_{i}{{< /imath >}}，于是就有
{{< math >}}

\mu(x,y) = (-1)^{k}

{{< /math >}}
小于 {{< imath >}}0{{< /imath >}} 当且仅当 {{< imath >}}k=1,3{{< /imath >}}。

我们分开计算 {{< imath >}}k=1,3{{< /imath >}} 的序对数量：
- {{< imath >}}k=1{{< /imath >}}，根据组合意义可以得到总数为 {{< imath >}}\binom{ 4 }{ 1 }\times 3^{1} \times 4^{3}=768{{< /imath >}}。
- {{< imath >}}k=3{{< /imath >}}，总数为 {{< imath >}}\binom{ 4 }{ 3 }\times 3^{3} \times 4=432{{< /imath >}}。

因此总数为 {{< imath >}}768+432=1200{{< /imath >}}。

## Problem 5

挑选两个在 {{< imath >}}[100]{{< /imath >}} 范围内均匀、独立随机的数字 {{< imath >}}a{{< /imath >}} 和 {{< imath >}}b{{< /imath >}}。在 {{< imath >}}[100]{{< /imath >}} 上的偏序关系定义为整除关系，求 {{< imath >}}\mu(a, b) = -1{{< /imath >}} 的概率。

**解**

**解**

我们考虑直接算出所有满足条件的 {{< imath >}}(a,b){{< /imath >}} 的总数。对于 {{< imath >}}\mu(a,b){{< /imath >}}，分类讨论：
- 如果 {{< imath >}}a \not\mid b{{< /imath >}}，那么 {{< imath >}}\mu(a,b)=0{{< /imath >}}。
- 如果 {{< imath >}}a=b{{< /imath >}}，那么 {{< imath >}}\mu(a,b)=1{{< /imath >}}。
- 如果 {{< imath >}}b=ka{{< /imath >}}（{{< imath >}}k \geq 2{{< /imath >}}），那么 {{< imath >}}\mu(a,b)=\mu(1,k){{< /imath >}}，其中 {{< imath >}}\mu(1,k)=(-1)^{\omega(k)}{{< /imath >}} 当 {{< imath >}}k{{< /imath >}} 无平方因子，否则 {{< imath >}}\mu(1,k)=0{{< /imath >}}。

因此 {{< imath >}}\mu(a,b)=-1{{< /imath >}} 当且仅当 {{< imath >}}k{{< /imath >}} 无平方因子且 {{< imath >}}\omega(k){{< /imath >}} 为奇数。定义 {{< imath >}}m{{< /imath >}} 为 {{< imath >}}\omega(k){{< /imath >}} 的奇数值，其可能取值 {{< imath >}}m=1,3{{< /imath >}}（因 {{< imath >}}k \leq 100{{< /imath >}}，最大 {{< imath >}}m=3{{< /imath >}}）。

我们分开计算 {{< imath >}}m=1,3{{< /imath >}} 的序对数量：
- {{< imath >}}m=1{{< /imath >}}（{{< imath >}}k{{< /imath >}} 为素数），总数为 {{< imath >}}\sum_{p \leq 100} \lfloor 100/p \rfloor =171{{< /imath >}}。
- {{< imath >}}m=3{{< /imath >}}（{{< imath >}}k{{< /imath >}} 为三个不同素数的乘积），此类 {{< imath >}}k=30,42,66,70,78{{< /imath >}}，总数为 {{< imath >}}\lfloor 100/30 \rfloor + \lfloor 100/42 \rfloor + \lfloor 100/66 \rfloor + \lfloor 100/70 \rfloor + \lfloor 100/78 \rfloor =3+2+1+1+1=8{{< /imath >}}。

因此总数为 {{< imath >}}171+8=179{{< /imath >}}，于是
{{< math >}}

\mathbb{P}(\mu(a,b)=-1) = \dfrac{179}{100^{2}} = \dfrac{179}{10000}.

{{< /math >}}
## Problem 6

设 {{< imath >}}a_1, a_2, \dots, a_n{{< /imath >}} 是一些实数，它们的绝对值都满足 {{< imath >}}|a_i| \ge 1{{< /imath >}}。考虑所有 {{< imath >}}2^n{{< /imath >}} 种线性组合 {{< imath >}}\sum_{i=1}^{n} \epsilon_i \cdot a_i{{< /imath >}}，其中每个 {{< imath >}}\epsilon_i{{< /imath >}} 可以取值 {{< imath >}}\{-1, +1\}{{< /imath >}}。请证明，这些和中落在任意区间 {{< imath >}}(x-1, x+1){{< /imath >}} 内的数量**至多**为 {{< imath >}}\binom{n}{\lfloor n/2 \rfloor}{{< /imath >}}。

**证**

我们稍微转化一下题目，令 {{< imath >}}b_{i}=2a_{i}{{< /imath >}}，取 {{< imath >}}\{ b_{n} \}{{< /imath >}} 的幂集 {{< imath >}}\mathcal{P}{{< /imath >}}，对于 {{< imath >}}S\in \mathcal{P}{{< /imath >}}，{{< imath >}}S{{< /imath >}} 中所有元素之和显然可以有一组 {{< imath >}}\sum_{i=1}^{n}\epsilon_{i}\cdot a_{i}{{< /imath >}} 平移得到，就这样 {{< imath >}}\mathcal{P}{{< /imath >}} 可以和 {{< imath >}}2^{n}{{< /imath >}} 中 {{< imath >}}a_{i}{{< /imath >}} 的线性组合一一对应。并且我们只需要考虑落在任意区间中的数量，所以平移操作并不会造成影响，于是我们的问题就转化成了 {{< imath >}}\mathcal{P}{{< /imath >}} 中集合的元素之和落在任意区间 {{< imath >}}(x-1,x+1){{< /imath >}} 内的集合数量至多位 {{< imath >}}\binom{ n }{ \lfloor n / 2 \rfloor }{{< /imath >}}。

假设集合 {{< imath >}}S{{< /imath >}} 是一个满足条件的集合。由于 {{< imath >}}\left| b_{i} \right|=2\left| a_{i} \right|>2{{< /imath >}}，因此在 {{< imath >}}S{{< /imath >}} 的基础上任意添加一个原来不包含的元素，至少会导致元素之和变化 {{< imath >}}2{{< /imath >}}，从而一定不会落在 {{< imath >}}(x-1,x+1){{< /imath >}} 中。这说明了若 {{< imath >}}\sum_{S}\in(x-1,x+1){{< /imath >}}，那么任意 {{< imath >}}S'{{< /imath >}} 满足 {{< imath >}}S\subset S'{{< /imath >}}，都有 {{< imath >}}\sum_{S'}\not\in (x-1,x+1){{< /imath >}}。

因此我们直接考虑偏序集 {{< imath >}}(\mathcal{P},\subseteq){{< /imath >}}。根据上面的分析，显然元素之和落在 {{< imath >}}(x-1,x+1){{< /imath >}} 的所有集合一定是一个反链。直接利用 Sperner 定理，得到此时反链的数量至多为 {{< imath >}}\binom{ n }{ \lfloor n / 2 \rfloor }{{< /imath >}}，因此满足条件的集合数量也至多为 {{< imath >}}\binom{ n }{ \lfloor n / 2 \rfloor }{{< /imath >}}。

