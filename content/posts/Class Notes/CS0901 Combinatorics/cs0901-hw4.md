---
tags:
- learning
- math
- combinatorics
- homework
discipline: mathematics
publish: true
date: '2025-10-09T21:26:00+08:00'
title: CS0901 HW4
categories:
- course-note
---
## Problem 1

证明存在常数 {{< imath >}}c > 1{{< /imath >}} 和 {{< imath >}}N > 0{{< /imath >}}，使得当 {{< imath >}}n > N{{< /imath >}} 时， {{< imath >}}[n]{{< /imath >}} 上树的同构类数量至少为 {{< imath >}}c^n{{< /imath >}} 。

**证**

我们需要的同构类的数量则可以看成 {{< imath >}}n{{< /imath >}} 个点无标号的树的数量。需要证明这个数量增长的足够快。

首先根据 Cayley 公式，{{< imath >}}n{{< /imath >}} 个点的有标号的树的数量为 {{< imath >}}n^{n-2}{{< /imath >}}。显然所有无标号的树的数量大于 {{< imath >}}\dfrac{n^{n-2}}{n!}{{< /imath >}}，因为这里直接假设所有点都是对称的，但是实际上一棵有标号的树并不会对应 {{< imath >}}n!{{< /imath >}} 颗无标号的树。我们直接取 {{< imath >}}c=2{{< /imath >}}，于是就只需要证明存在 {{< imath >}}N>0{{< /imath >}} 满足在 {{< imath >}}n>N{{< /imath >}} 时有
{{< math >}}

\dfrac{n^{n-2}}{n!} > 2^{n}

{{< /math >}}
我们使用斯特林公式，在 {{< imath >}}n{{< /imath >}} 足够大时有
{{< math >}}

n! \approx \sqrt{ 2\pi n }\left( \dfrac{n}{e} \right)^{n}

{{< /math >}}
带入下界，得到
{{< math >}}

\dfrac{n^{n-2}}{n!} \approx \dfrac{e^{n}}{\sqrt{ 2\pi}\cdot n^{5 / 2}}

{{< /math >}}
所以只需要证明在 {{< imath >}}n>N{{< /imath >}} 时有
{{< math >}}

(\sqrt{ 2\pi })^{1 / n} \cdot n^{5 / 2n} < \dfrac{e}{2}

{{< /math >}}
对于左式，显然有
{{< math >}}

\lim_{ n \to \infty } [(\sqrt{ 2\pi })^{1 / n} \cdot n^{5 / 2n}] = 1 < \dfrac{e}{2}

{{< /math >}}
根据极限的定义，我们总能找到一个 {{< imath >}}N{{< /imath >}} 满足条件。因此得证！

## Problem 2

1. 假设 {{< imath >}}G{{< /imath >}} 是 {{< imath >}}[n]{{< /imath >}} 上的一个图，且 {{< imath >}}G \cong \overline{G}{{< /imath >}} 。证明如果 {{< imath >}}n = 4k + 1{{< /imath >}} （其中 {{< imath >}}k{{< /imath >}} 是某个整数），则存在一个度为 {{< imath >}}2k{{< /imath >}} 的顶点。
2. 对于哪些 {{< imath >}}n{{< /imath >}} 值，存在一个 {{< imath >}}[n]{{< /imath >}} 上的图 {{< imath >}}G{{< /imath >}} 使得 {{< imath >}}G \cong \overline{G}{{< /imath >}} 成立？证明你的答案。

**(1)**

我们需要证明一个无向图和它的补图同构时，如果 {{< imath >}}n=4k+1{{< /imath >}}，那么存在度数为 {{< imath >}}\frac{n-1}{2}{{< /imath >}} 的顶点。

首先我们设 {{< imath >}}G=(V,E){{< /imath >}}。{{< imath >}}G \cong \overline{G}{{< /imath >}} 说明对于任意 {{< imath >}}v\in V{{< /imath >}}，均存在 {{< imath >}}u\in V{{< /imath >}} 满足 {{< imath >}}\text{deg}(v) = (n-1)-\text{deg}(u){{< /imath >}}（补图中所有点的度数组成的序列和原来相同）。这说明对于任意一个度数 {{< imath >}}d{{< /imath >}}，均存在 {{< imath >}}(n-1)-d{{< /imath >}} 与之对应。

假设不存在 {{< imath >}}d= \frac{n-1}{2}{{< /imath >}}，那么我们就能把所有点按照度数两两配对成度数为 {{< imath >}}(d,n-1-d){{< /imath >}} 的对（因为 {{< imath >}}d\neq n-1-d{{< /imath >}}）。然而由于 {{< imath >}}n{{< /imath >}} 是奇数，必然有一个点无法配对，因此矛盾。所以必然存在度数为 {{< imath >}}\frac{n-1}{2}{{< /imath >}} 的点。

**(2)**

首先必须要满足 {{< imath >}}G{{< /imath >}} 和 {{< imath >}}\overline{G}{{< /imath >}} 的边数相等，因此
{{< math >}}

\left| E \right| = \binom{ n }{ 2 }  - \left| E \right| 

{{< /math >}}
得到 {{< imath >}}\left| E \right|= \dfrac{n(n-1)}{4}{{< /imath >}}，从而有 {{< imath >}}n=4k{{< /imath >}} 或 {{< imath >}}n=4k+1{{< /imath >}}。

接着我们考虑用更形式化的方式描述 {{< imath >}}G \cong \overline{G}{{< /imath >}}。这等价于存在一个 {{< imath >}}n{{< /imath >}} 的置换 {{< imath >}}\varphi:[n]\to[n]{{< /imath >}} 满足对于所有 {{< imath >}}(u,v)\in E{{< /imath >}}，那么 {{< imath >}}(\varphi(u),\varphi(v))\not\in E{{< /imath >}}。

我们现在分别对 {{< imath >}}n=4k{{< /imath >}} 和 {{< imath >}}n=4k+1{{< /imath >}} 两种情况都构造出对应的 {{< imath >}}G{{< /imath >}} ，证明只要 {{< imath >}}n\equiv 0,1\pmod 4{{< /imath >}}，就存在对应的 {{< imath >}}G{{< /imath >}}。

**Case 1**：若 {{< imath >}}n\equiv 0\pmod 4{{< /imath >}}。我们取 {{< imath >}}\varphi[n]=(2,3,\dots,n,1){{< /imath >}}，即 {{< imath >}}\varphi(k)=k+1\pmod n{{< /imath >}}。由于 {{< imath >}}n{{< /imath >}} 为偶数，所以我们将所有点按照 {{< imath >}}1,\dots,n{{< /imath >}} 编号，可以将所有的点按照编号分成奇数和偶数两组，显然在这种构造下，令 {{< imath >}}G{{< /imath >}} 包含所有两端点编号为奇数的边，比如 {{< imath >}}(u,v){{< /imath >}}，必然有 {{< imath >}}\varphi(u,v)\not\in E{{< /imath >}}。

除此之外还需要包含一半的两端编号奇偶不同的边。若 {{< imath >}}i{{< /imath >}} 为奇数，{{< imath >}}j{{< /imath >}} 为偶数，我们考虑边 {{< imath >}}(i,j){{< /imath >}} 和所有端点编号之差（{{< imath >}}\text{mod }n{{< /imath >}}）相同的边，显然对于任意 {{< imath >}}u\in[n]{{< /imath >}}，都能找到对应的 {{< imath >}}v\equiv u+(i-j)\pmod n{{< /imath >}} 使得 {{< imath >}}(u,v){{< /imath >}} 为这样的一条边，所以我们不妨设所有的这些边为 {{< imath >}}(1,j_{1}),(2,j_{2}),\dots ,(n,j_{n}){{< /imath >}}，并且这些边按照 {{< imath >}}\varphi{{< /imath >}} 的调用关系形成了一个长度为 {{< imath >}}n{{< /imath >}} 的环。所以我们直接在这个环上间隔地取边加入到 {{< imath >}}G{{< /imath >}} 中，就构造出了正确的边集，具体而言，取 {{< imath >}}(2k+1,j_{2k+1}){{< /imath >}}。对于所有的环，都用这样的方式取出一半的边加入到 {{< imath >}}G{{< /imath >}}，最终得到的边集
{{< math >}}

E = \{ (u,v)\mid u\equiv v\equiv 1\pmod  n \} \cup \{ (u,(u+t)\text{ mod }n)\mid u \in [n],t \in \{1,3,\dots,n-1  \} \}

{{< /math >}}
容易验证这时 {{< imath >}}\varphi(E)\cap E=\emptyset{{< /imath >}} 并且 {{< imath >}}\varphi(E)\cup E=\binom{[n] }{ 2 }{{< /imath >}}。

**Case 2**：若 {{< imath >}}n\equiv 1\pmod 4{{< /imath >}}。设 {{< imath >}}n = 4k + 1{{< /imath >}}。将顶点集标记为 {{< imath >}}\{0, 1, \dots, 4k-1, \infty\}{{< /imath >}}。定义置换 {{< imath >}}\varphi{{< /imath >}} 如下： {{< imath >}}\varphi(\infty) = \infty{{< /imath >}}，且对于 {{< imath >}}i = 0, 1, \dots, 4k-1{{< /imath >}}， {{< imath >}}\varphi(i) = (i + 1) \mod 4k{{< /imath >}}。 

该置换 {{< imath >}}\varphi{{< /imath >}} 在边集上的作用将所有可能的边根据端点编号的差值划分为不同的组，每个组的大小均为偶数。具体而言： 
- 与 {{< imath >}}\infty{{< /imath >}} 相连的边 {{< imath >}}\{\infty, i\}{{< /imath >}}（{{< imath >}}i = 0, \dots, 4k-1{{< /imath >}}）形成一个为大小 {{< imath >}}4k{{< /imath >}}（偶数）的组。 
- 其余边 {{< imath >}}\{i, j\}{{< /imath >}}（{{< imath >}}i, j \in \{0, \dots, 4k-1\}{{< /imath >}}， {{< imath >}}i \neq j{{< /imath >}}）的形成的组大小也均为偶数（取决于差异 {{< imath >}}d = |i - j| \mod 4k{{< /imath >}}，但均为偶数）。 

对于每个组（视为 {{< imath >}}\varphi{{< /imath >}} 作用下的环），选择交替的半数边加入 （即同一组中相邻边一在 {{< imath >}}G{{< /imath >}} 中，一不在，确保与 {{< imath >}}\varphi(G) = \overline{G}{{< /imath >}} 一致）。由于总数为偶数，此选择无矛盾，且确保 {{< imath >}}E \cup \varphi(E) = \binom{[n]}{2}{{< /imath >}} 且 {{< imath >}}E \cap \varphi(E) = \emptyset{{< /imath >}}，从而 {{< imath >}}G \cong \overline{G}{{< /imath >}}。 

此构造证明了当 {{< imath >}}n \equiv 1 \pmod{4}{{< /imath >}} 时，存在满足条件的图 {{< imath >}}G{{< /imath >}}。

## Problem 3

在一个连通图 {{< imath >}}G{{< /imath >}} 中，如果存在不止一条最长路径，证明任意两条最长路径都共享一个共同顶点。

**证**

假设有两条不重合的最长路径，端点分别为 {{< imath >}}(s,t),(s',t'){{< /imath >}}，路径长度为 {{< imath >}}l{{< /imath >}}。设 {{< imath >}}(s,t){{< /imath >}} 上的顶点 {{< imath >}}a{{< /imath >}} 和 {{< imath >}}(s',t'){{< /imath >}} 上的顶点 {{< imath >}}b{{< /imath >}} 满足 {{< imath >}}(a,b){{< /imath >}} 的最短路径 {{< imath >}}S{{< /imath >}} 不属于 {{< imath >}}(s,t){{< /imath >}} 和 {{< imath >}}(s',t'){{< /imath >}}。我们设 {{< imath >}}(s,a){{< /imath >}} 的长度为 {{< imath >}}d_{1}{{< /imath >}}，{{< imath >}}(b,t'){{< /imath >}} 的长度为 {{< imath >}}d_{2}{{< /imath >}}。

因此我们可以以此构造出 {{< imath >}}4{{< /imath >}} 条路径：
- {{< imath >}}s\to a\to b\to t'{{< /imath >}}：长度为 {{< imath >}}d_{1}+\left| S \right|+d_{2}{{< /imath >}}。
- {{< imath >}}s\to a\to b\to s'{{< /imath >}}：长度为 {{< imath >}}d_{1}+\left| S \right|+l-d_{2}{{< /imath >}}。
- {{< imath >}}t\to a\to b\to t'{{< /imath >}}：长度为 {{< imath >}}l-d_{1}+\left| S \right|+d_{2}{{< /imath >}}。
- {{< imath >}}t\to a\to b\to s'{{< /imath >}}：长度为 {{< imath >}}l-d_{1}+\left| S \right|+l-d_{2}{{< /imath >}}。

这 {{< imath >}}4{{< /imath >}} 条路径长度之和为 {{< imath >}}4l+4\left| S \right|{{< /imath >}}，说明其平均长度为 {{< imath >}}l+\left| S \right|>l{{< /imath >}}，其中肯定至少有一条长度大于 {{< imath >}}l{{< /imath >}} 的路径，这与 {{< imath >}}l{{< /imath >}} 是最长路径矛盾！

说明不存在不重合的最长路径。

## Problem 4 (Bonus)

证明或反驳：在一个连通图中，所有最长路径（如果多于一条）都共享一个共同顶点。

**反例**

我们考虑构造一个图满足，对于图中任意一个点都存在一条最长路径经过除了这个点以外的所有点，这样所有最长路径的交集就是空集，可以作为一个反例。

